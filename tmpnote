
Test 1: 32B model

```
============ Serving Benchmark Result ============
Successful requests:                     10        
Benchmark duration (s):                  15.32     
Total input tokens:                      10239     
Total generated tokens:                  1280      
Request throughput (req/s):              0.65      
Output token throughput (tok/s):         83.54     
Total Token throughput (tok/s):          751.76    
---------------Time to First Token----------------
Mean TTFT (ms):                          406.76    
Median TTFT (ms):                        426.54    
P99 TTFT (ms):                           434.09    
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          117.26    
Median TPOT (ms):                        117.19    
P99 TPOT (ms):                           117.92    
---------------Inter-token Latency----------------
Mean ITL (ms):                           117.26    
Median ITL (ms):                         117.27    
P99 ITL (ms):                            130.44    
==================================================
```

```
============ Serving Benchmark Result ============
Successful requests:                     10        
Benchmark duration (s):                  15.24     
Total input tokens:                      20431     
Total generated tokens:                  1280      
Request throughput (req/s):              0.66      
Output token throughput (tok/s):         83.97     
Total Token throughput (tok/s):          1424.23   
---------------Time to First Token----------------
Mean TTFT (ms):                          402.07    
Median TTFT (ms):                        423.50    
P99 TTFT (ms):                           429.40    
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          116.70    
Median TPOT (ms):                        116.61    
P99 TPOT (ms):                           117.41    
---------------Inter-token Latency----------------
Mean ITL (ms):                           116.70    
Median ITL (ms):                         116.04    
P99 ITL (ms):                            129.78    
==================================================
```

```
============ Serving Benchmark Result ============
Successful requests:                     10        
Benchmark duration (s):                  63.72     
Total input tokens:                      40952     
Total generated tokens:                  1280      
Request throughput (req/s):              0.16      
Output token throughput (tok/s):         20.09     
Total Token throughput (tok/s):          662.77    
---------------Time to First Token----------------
Mean TTFT (ms):                          26058.47  
Median TTFT (ms):                        20612.53  
P99 TTFT (ms):                           52809.36  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          197.37    
Median TPOT (ms):                        244.78    
P99 TPOT (ms):                           245.36    
---------------Inter-token Latency----------------
Mean ITL (ms):                           197.37    
Median ITL (ms):                         94.89     
P99 ITL (ms):                            2420.75   
==================================================

(APIServer pid=118) INFO 09-02 05:20:47 [loggers.py:123] Engine 000: Avg prompt throughput: 1634.2 tokens/s, Avg generation throughput: 5.1 tokens/s, Running: 16 reqs, Waiting: 3 reqs, GPU KV cache usage: 63.1%, Prefix cache hit rate: 37.4%
(APIServer pid=118) INFO 09-02 05:20:57 [loggers.py:123] Engine 000: Avg prompt throughput: 409.0 tokens/s, Avg generation throughput: 109.9 tokens/s, Running: 19 reqs, Waiting: 0 reqs, GPU KV cache usage: 79.3%, Prefix cache hit rate: 36.9%
(APIServer pid=118) INFO 09-02 05:21:07 [loggers.py:123] Engine 000: Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 127.6 tokens/s, Running: 0 reqs, Waiting: 0 reqs, GPU KV cache usage: 0.1%, Prefix cache hit rate: 36.9%
```


```
============ Serving Benchmark Result ============
Successful requests:                     10        
Benchmark duration (s):                  122.88    
Total input tokens:                      80586     
Total generated tokens:                  1280      
Request throughput (req/s):              0.08      
Output token throughput (tok/s):         10.42     
Total Token throughput (tok/s):          666.23    
---------------Time to First Token----------------
Mean TTFT (ms):                          55980.42  
Median TTFT (ms):                        52079.35  
P99 TTFT (ms):                           112779.23 
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          179.10    
Median TPOT (ms):                        182.48    
P99 TPOT (ms):                           234.76    
---------------Inter-token Latency----------------
Mean ITL (ms):                           179.10    
Median ITL (ms):                         85.82     
P99 ITL (ms):                            2428.84   
==================================================

(APIServer pid=118) INFO 09-02 05:53:29 [loggers.py:123] Engine 000: Avg prompt throughput: 1609.2 tokens/s, Avg generation throughput: 25.8 tokens/s, Running: 3 reqs, Waiting: 7 reqs, GPU KV cache usage: 94.0%, Prefix cache hit rate: 21.5%
(APIServer pid=118) INFO 09-02 05:53:39 [loggers.py:123] Engine 000: Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 12.0 tokens/s, Running: 3 reqs, Waiting: 6 reqs, GPU KV cache usage: 81.6%, Prefix cache hit rate: 20.1%
(APIServer pid=118) INFO 09-02 05:53:49 [loggers.py:123] Engine 000: Avg prompt throughput: 803.1 tokens/s, Avg generation throughput: 0.5 tokens/s, Running: 2 reqs, Waiting: 5 reqs, GPU KV cache usage: 50.2%, Prefix cache hit rate: 20.0%
(APIServer pid=118) INFO 09-02 05:53:59 [loggers.py:123] Engine 000: Avg prompt throughput: 799.7 tokens/s, Avg generation throughput: 0.7 tokens/s, Running: 3 reqs, Waiting: 4 reqs, GPU KV cache usage: 81.6%, Prefix cache hit rate: 20.0%
(APIServer pid=118) INFO 09-02 05:54:09 [loggers.py:123] Engine 000: Avg prompt throughput: 805.6 tokens/s, Avg generation throughput: 26.6 tokens/s, Running: 3 reqs, Waiting: 4 reqs, GPU KV cache usage: 93.8%, Prefix cache hit rate: 18.8%
(APIServer pid=118) INFO 09-02 05:54:19 [loggers.py:123] Engine 000: Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 10.0 tokens/s, Running: 3 reqs, Waiting: 3 reqs, GPU KV cache usage: 83.0%, Prefix cache hit rate: 18.5%
(APIServer pid=118) INFO 09-02 05:54:30 [loggers.py:123] Engine 000: Avg prompt throughput: 803.1 tokens/s, Avg generation throughput: 1.1 tokens/s, Running: 3 reqs, Waiting: 2 reqs, GPU KV cache usage: 91.1%, Prefix cache hit rate: 18.5%
(APIServer pid=118) INFO 09-02 05:54:40 [loggers.py:123] Engine 000: Avg prompt throughput: 805.4 tokens/s, Avg generation throughput: 0.9 tokens/s, Running: 3 reqs, Waiting: 1 reqs, GPU KV cache usage: 91.1%, Prefix cache hit rate: 18.4%
(APIServer pid=118) INFO 09-02 05:54:50 [loggers.py:123] Engine 000: Avg prompt throughput: 805.3 tokens/s, Avg generation throughput: 28.8 tokens/s, Running: 3 reqs, Waiting: 1 reqs, GPU KV cache usage: 94.1%, Prefix cache hit rate: 18.5%
```


```
$ python /home/cdsw/vllm/benchmarks/benchmark_serving.py --backend vllm --host 10.254.5.31 --port 8081 --endpoint='/v1/completions' --model Qwen2.5-32B-Instruct --dataset-name random  --num-prompts 10 --random-input-len 4096 --random-output-len 4096

============ Serving Benchmark Result ============
Successful requests:                     10        
Benchmark duration (s):                  1076.61   
Total input tokens:                      40952     
Total generated tokens:                  40960     
Request throughput (req/s):              0.01      
Output token throughput (tok/s):         38.05     
Total Token throughput (tok/s):          76.08     
---------------Time to First Token----------------
Mean TTFT (ms):                          233987.48 
Median TTFT (ms):                        23589.87  
P99 TTFT (ms):                           752280.98 
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          113.57    
Median TPOT (ms):                        94.28     
P99 TPOT (ms):                           176.24    
---------------Inter-token Latency----------------
Mean ITL (ms):                           113.60    
Median ITL (ms):                         83.72     
P99 ITL (ms):                            112.26    
==================================================

(APIServer pid=117) INFO 09-02 06:26:02 [loggers.py:123] Engine 000: Avg prompt throughput: 408.8 tokens/s, Avg generation throughput: 6.3 tokens/s, Running: 2 reqs, Waiting: 8 reqs, GPU KV cache usage: 31.6%, Prefix cache hit rate: 33.2%
(APIServer pid=117) INFO 09-02 06:26:12 [loggers.py:123] Engine 000: Avg prompt throughput: 818.0 tokens/s, Avg generation throughput: 1.0 tokens/s, Running: 4 reqs, Waiting: 6 reqs, GPU KV cache usage: 63.1%, Prefix cache hit rate: 19.9%
(APIServer pid=117) INFO 09-02 06:26:22 [loggers.py:123] Engine 000: Avg prompt throughput: 1225.9 tokens/s, Avg generation throughput: 9.6 tokens/s, Running: 6 reqs, Waiting: 4 reqs, GPU KV cache usage: 94.9%, Prefix cache hit rate: 5.0%
(APIServer pid=117) INFO 09-02 06:26:32 [loggers.py:123] Engine 000: Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 59.9 tokens/s, Running: 6 reqs, Waiting: 4 reqs, GPU KV cache usage: 97.2%, Prefix cache hit rate: 0.8%
(APIServer pid=117) INFO 09-02 06:26:42 [loggers.py:123] Engine 000: Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 59.8 tokens/s, Running: 6 reqs, Waiting: 4 reqs, GPU KV cache usage: 99.4%, Prefix cache hit rate: 0.5%
(APIServer pid=117) INFO 09-02 06:26:52 [loggers.py:123] Engine 000: Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 53.1 tokens/s, Running: 5 reqs, Waiting: 5 reqs, GPU KV cache usage: 84.9%, Prefix cache hit rate: 24.8%
(APIServer pid=117) INFO 09-02 06:27:02 [loggers.py:123] Engine 000: Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 49.4 tokens/s, Running: 5 reqs, Waiting: 5 reqs, GPU KV cache usage: 86.8%, Prefix cache hit rate: 39.5%
(APIServer pid=117) INFO 09-02 06:27:12 [loggers.py:123] Engine 000: Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 49.8 tokens/s, Running: 5 reqs, Waiting: 5 reqs, GPU KV cache usage: 88.7%, Prefix cache hit rate: 46.2%
(APIServer pid=117) INFO 09-02 06:27:22 [loggers.py:123] Engine 000: Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 49.9 tokens/s, Running: 5 reqs, Waiting: 5 reqs, GPU KV cache usage: 90.6%, Prefix cache hit rate: 48.8%


```


Test 2: 7B model

Before loading KV cache,
<img width="700" height="200" alt="image" src="https://github.com/user-attachments/assets/77dbd949-88e9-46f0-b833-78888a31d083" />

```
Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:57<02:52, 57.61s/it]
Loading safetensors checkpoint shards:  50% Completed | 2/4 [01:52<01:51, 55.96s/it]
```

After KV cache is loaded,
<img width="700" height="196" alt="image" src="https://github.com/user-attachments/assets/7b127f14-2ef5-40b0-b78b-90f9fecf6f75" />


```
============ Serving Benchmark Result ============
Successful requests:                     250       
Benchmark duration (s):                  41.02     
Total input tokens:                      255124    
Total generated tokens:                  31742     
Request throughput (req/s):              6.09      
Output token throughput (tok/s):         773.85    
Total Token throughput (tok/s):          6993.59   
---------------Time to First Token----------------
Mean TTFT (ms):                          4030.55   
Median TTFT (ms):                        1628.12   
P99 TTFT (ms):                           24148.84  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          279.17    
Median TPOT (ms):                        295.72    
P99 TPOT (ms):                           298.42    
---------------Inter-token Latency----------------
Mean ITL (ms):                           277.47    
Median ITL (ms):                         153.01    
P99 ITL (ms):                            818.49    
==================================================

(APIServer pid=119) INFO 09-02 08:42:37 [loggers.py:123] Engine 000: Avg prompt throughput: 2541.7 tokens/s, Avg generation throughput: 117.6 tokens/s, Running: 103 reqs, Waiting: 40 reqs, GPU KV cache usage: 26.2%, Prefix cache hit rate: 58.4%
(APIServer pid=119) INFO 09-02 08:42:47 [loggers.py:123] Engine 000: Avg prompt throughput: 2858.4 tokens/s, Avg generation throughput: 163.7 tokens/s, Running: 130 reqs, Waiting: 12 reqs, GPU KV cache usage: 33.2%, Prefix cache hit rate: 56.9%
```

```
============ Serving Benchmark Result ============
Successful requests:                     400       
Benchmark duration (s):                  177.07    
Total input tokens:                      408335    
Total generated tokens:                  50923     
Request throughput (req/s):              2.26      
Output token throughput (tok/s):         287.58    
Total Token throughput (tok/s):          2593.63   
---------------Time to First Token----------------
Mean TTFT (ms):                          78042.97  
Median TTFT (ms):                        75852.90  
P99 TTFT (ms):                           163364.23 
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          595.26    
Median TPOT (ms):                        717.87    
P99 TPOT (ms):                           795.95    
---------------Inter-token Latency----------------
Mean ITL (ms):                           594.95    
Median ITL (ms):                         785.18    
P99 ITL (ms):                            815.75    
==================================================

(APIServer pid=119) INFO 09-02 08:54:47 [loggers.py:123] Engine 000: Avg prompt throughput: 2351.4 tokens/s, Avg generation throughput: 302.4 tokens/s, Running: 241 reqs, Waiting: 154 reqs, GPU KV cache usage: 63.5%, Prefix cache hit rate: 35.5%
(APIServer pid=119) INFO 09-02 08:54:57 [loggers.py:123] Engine 000: Avg prompt throughput: 2144.6 tokens/s, Avg generation throughput: 286.7 tokens/s, Running: 238 reqs, Waiting: 133 reqs, GPU KV cache usage: 62.8%, Prefix cache hit rate: 35.0%
(APIServer pid=119) INFO 09-02 08:55:07 [loggers.py:123] Engine 000: Avg prompt throughput: 2147.6 tokens/s, Avg generation throughput: 285.6 tokens/s, Running: 236 reqs, Waiting: 112 reqs, GPU KV cache usage: 62.4%, Prefix cache hit rate: 34.6%
(APIServer pid=119) INFO 09-02 08:55:17 [loggers.py:123] Engine 000: Avg prompt throughput: 2351.4 tokens/s, Avg generation throughput: 305.2 tokens/s, Running: 233 reqs, Waiting: 89 reqs, GPU KV cache usage: 61.6%, Prefix cache hit rate: 34.1%
(APIServer pid=119) INFO 09-02 08:55:27 [loggers.py:123] Engine 000: Avg prompt throughput: 2225.6 tokens/s, Avg generation throughput: 277.8 tokens/s, Running: 231 reqs, Waiting: 67 reqs, GPU KV cache usage: 60.9%, Prefix cache hit rate: 33.7%
(APIServer pid=119) INFO 09-02 08:55:37 [loggers.py:123] Engine 000: Avg prompt throughput: 2441.5 tokens/s, Avg generation throughput: 301.4 tokens/s, Running: 231 reqs, Waiting: 43 reqs, GPU KV cache usage: 60.7%, Prefix cache hit rate: 33.3%
```
